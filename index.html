<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Netflix Movie Generator</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

</head>

<body>
    <div class="nav">

    </div>
    <div class="searchbar">
        <form>
            <fieldset>
                <legend>User Preference</legend>
                <p>
                    <label>Select Genre</label>
                    <select id="genres">
                        <option value="801362">Action</option>
                        <option value="7442">Adventure</option>
                        <option value="7424">Anime</option>
                        <option value="6548">Comedy</option>
                        <option value="5763">Drama</option>
                        <option value="8711">Horror</option>
                        <option value="13335">Musical</option>
                        <option value="1255">Romance Drama</option>
                    </select>
                </p>
                <p>
                    <label>Select Country</label>
                    <select id="countries">
                        <option value="23">Australia</option>
                        <option value="33">Canada</option>
                        <option value="327">Greece</option>
                        <option value="337">India</option>
                        <option value="55">Ireland</option>
                        <option value="391">Pakistan</option>
                        <option value="46">United Kingdom</option>
                        <option value="78">United States</option>
                    </select>
                </p>
            </fieldset>
        </form>
        <button id="searchBtn">
            Movie Search
        </button>
    </div>
    <div class="movieresults">
        <div class="carousel">

        </div>
    </div>
    <div class="footer">

    </div>

    <script>

        $("#searchBtn").on("click", function () {
            var userGenre = $('#genres').val();
            console.log(userGenre);
            var userCountry = $('#countries').val();
            console.log(userCountry);

            var settings = {
                "async": true,
                "crossDomain": true,
                "url": "https://unogs-unogs-v1.p.rapidapi.com/aaapi.cgi?q=get%253Anew1000-!1900%2C2018-!0%2C5-!0%2C10-!" + userGenre + "-!Any-!Any-!Any-!gt100-!%7Bdownloadable%7D&t=ns&cl=" + userCountry + "&st=adv&ob=Relevance&p=1&sa=and",
                "method": "GET",
                "headers": {
                    "x-rapidapi-host": "unogs-unogs-v1.p.rapidapi.com",
                    "x-rapidapi-key": "f1bd960599msh649fc643e8fdbcep118c63jsn3b463af5d748"
                }
            }
            console.log(settings.url);

            $.ajax(settings).done(function (response) {
                console.log(response);
                console.log(response.ITEMS[0].image);
               
               //starting dynamically creating carousel
                var arr = ["#one!", "#two!", "#three!", "#four!", "#five!"]

                for (i=0; i < arr.length ; i++) 
                {
                    console.log("hello!");
                    //making carousel item div and giving it an id matching i and href matching the arr
                    var newDiv = $("<div>");
                    newDiv.addClass("carousel-item");
                    newDiv.attr("id", i);
                    newDiv.attr("href", arr[i]);

                    //making new image with movie poster from response
                    var newImage = $("<img>");
                    newImage.attr("src", response.ITEMS[i].image);

                    //making mini div with movie information
                    var miniDiv = $("<div>");
                    var movieTitle = $("<h1>");
                    movieTitle.text(response.ITEMS[i].title);
                    var moviePlot = $("<p>");
                    moviePlot.text(response.ITEMS[i].synopsis);
                    var movieRating = $("<p>");
                    movieRating.text(response.ITEMS[i].rating + " /10 as chosen by IMBD users");
                    var movieLength = $("<p>");
                    movieLength.text(response.ITEMS[i].runtime);
                    miniDiv.append(movieTitle);
                    miniDiv.append(moviePlot);
                    miniDiv.append(movieRating);
                    miniDiv.append(movieLength);

                    //making div id easier to read
                    var carouselItemDivId = "#"+i;
                    $(carouselItemDivId).append(miniDiv);
                    $(carouselItemDivId).append(newImage);
                    $(".carousel").append(carouselItemDivId);
                }
                // carousel but with the .on document ready removed as it is on ajax done
                $('.carousel').carousel();
                    


            });
        })


    </script>
</body>

</html>


<!-- Object:
COUNT: "32"
ITEMS: Array(32)
0:
download: "1"
image: "https://occ-0-2219-2218.1.nflxso.net/dnm/api/v6/XsrytRUxks8BtTRf9HNlZkW2tvY/AAAABRiPIAVRnSybl_joINOjJw7FepvHyJyTXXC-kgc8fVnkdmKKbhozo1y8aX-t2g2dmELp3XKuNfOqaynTYMC0RuVesg.jpg?r=97c"
imdbid: "tt0116126"
largeimage: "http://cdn0.nflximg.net/images/4156/10924156.jpg"
netflixid: "452508"
rating: "6.6"
released: "1996"
runtime: "1h28m"
synopsis: "In this goofy send-up of the gritty urban movies of the early 1990s, Ashtray moves to South Central L.A. and falls in with his gang-banging cousin.<br><b>New on 2019-12-04</b>"
title: "Don&#39;t Be a Menace to South Central While Drinking Your Juice in the Hood"
type: "movie"
unogsdate: "2019-12-04" -->